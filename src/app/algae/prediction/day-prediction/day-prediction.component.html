<!-- TITULO -->
<div class="col-sm-12 col-md-6">
  <h3 class="text-primary text-start mb-4 fw-semibold">Single-Day Prediction</h3>
</div>

<!-- Seccion Panel prediccion-->
<div>
  <div class="mt-4"><!-- titulo-->
          <h2 class="h5 text-muted fw-semibold mb-3">
              <i class="fas fa-cogs fa-sm text-secondary me-2"></i> Data Prediction
          </h2>
  </div>

  <!-- cuerpo-->
  <div class="card border-0 shadow-sm mb-5">
    <!-- Header-->
    <div class="card-header bg-primary bg-opacity-10 py-3 border-bottom"></div>
    <!-- formulario-->
    <form [formGroup]="predictionForm" (ngSubmit)="runPrediction()">

      <div class="grid-container ">
        
        <!-- Primera columna seccion sitio y especies -->
          <div>
            <div class="sitio-section mb-1"><!-- seccion de sitio -->
              <div class="d-flex mb-1"><!-- titulo seccion-->
                <i class="fas fa-map-marker-alt text-primary mt-1 me-3"></i>
                <div>
                  <h6 class="mb-0 text-dark">Site</h6>
                </div>
              </div>
              <div class="btn-group btn-group-toggle d-flex flex-wrap" role="group">
                <button
                  type="button"
                  *ngFor="let site of sites"
                  class="btn btn-outline-primary m-1"
                  [class.active]="predictionForm.get('site')?.value === site.name"
                  (click)="predictionForm.get('site')?.setValue(site.name)"
                >
                  {{ site.name }}
                </button>
              </div>
              <div *ngIf="isInvalid('site')" class="text-danger mt-1 small">Select a valid site.</div>
            </div>

            <div class="especie-section mt-1"><!-- seccion de especie -->
              <div class="d-flex mb-1"><!-- titulo seccion-->
                <i class="fas fa-seedling mt-1 me-3" style="color: #1cc88a;"></i>
                <div>
                  <h6 class="mb-0 text-dark">Algae species</h6>
                </div>
              </div>
              <div class="btn-group btn-group-toggle d-flex flex-wrap" role="group">
                <button
                  type="button"
                  *ngFor="let algae of species"
                  class="btn btn-outline-success m-1"
                  [class.active]="predictionForm.get('specie')?.value === algae.name"
                  (click)="predictionForm.get('specie')?.setValue(algae.name)"
                >
                  {{ algae.name }}
                </button>
              </div>
              <div *ngIf="isInvalid('specie')" class="text-danger mt-1 small">Select a valid species.</div>
            </div>
          </div>

        <!-- Segunda columna con inputs -->
          <div>
            <!-- parameter temperature-->
            <!-- <div class="mt-2 mb-3"> 
              <div class="d-flex mb-2 ms-2">
                <i class="fas fa-temperature-high text-secondary mt-1 me-3"></i>
                <div>
                  <h6 class="mb-0">Temperature (°C)</h6>
                </div>
              </div>
              <input
                type="number"
                class="form-control"
                id="temperature"
                formControlName="temperature"
                [ngClass]="{ 'is-invalid': isInvalid('temperature') }"
                min="0" max="50"
              />
              <div class="invalid-feedback">Temperature must be between 0 and 50 °C.</div>
            </div> -->

            <!-- parameter din-->
            <!-- <div class="mb-3">
              <div class="d-flex mb-2 ms-2">
                <i class="fas fa-water text-secondary mt-1 me-3"></i>
                <div>
                  <h6 class="mb-0">DIN (µmol/L)</h6>
                </div>
              </div>
              <input
                type="number"
                class="form-control"
                id="din"
                formControlName="din"
                [ngClass]="{ 'is-invalid': isInvalid('din') }"
                min="0"
              />
              <div class="invalid-feedback">DIN must be a positive number.</div>
            </div> -->

            <!-- parameter nt -->
            <!-- <div class="mb-3">
              <div class="d-flex mb-2 ms-2">
                <i class="fas fa-flask text-secondary mt-1 me-3"></i>
                <div>
                  <h6 class="mb-0">NT (µmol/L)</h6>
                </div>
              </div>
              <input
                type="number"
                class="form-control"
                id="nt"
                formControlName="nt"
                [ngClass]="{ 'is-invalid': isInvalid('nt') }"
                min="0"
              />
              <div class="invalid-feedback">NT must be a positive number.</div>
            </div> -->

            <div class="mb-3"><!-- date-->
              <div class="d-flex mb-2 ms-2">
                <i class="fas fa-calendar-day text-secondary mt-1 me-3"></i>
                <div>
                  <h6 class="mb-0">Prediction Date</h6>
                </div>
              </div>
              <input
                type="date"
                class="form-control"
                id="date"
                formControlName="date"
                [ngClass]="{ 'is-invalid': isInvalid('date') }"
                min="1"
              />
              <div class="invalid-feedback">Enter a valid date.</div>
            </div>

            <!-- Predict botton-->
            <button type="submit" class="btn btn-primary mt-3 w-100 fw-semibold">Predict</button>
          </div>

      </div>

      <!-- Result-->
      <div *ngIf="result" class="alert alert-info me-2 ms-2 fw-semibold">
          {{ result }}
      </div>
    </form>
  </div>
</div>

<div><!--Seccion Resultado de prediccion-->
<!-- titulo-->  
  <div class="mt-4">
      
        <h2 class="h5 text-muted fw-semibold mb-3">
            <i class="fas fa-chart-line fa-sm text-secondary me-2"></i> Prediction Results
        </h2>
    </div>

  <div class="card border-0 shadow-sm mb-5"><!-- seccion card--> 
    <!-- Header-->
    <div class="card-header bg-primary bg-opacity-10 py-3 border-bottom"></div>

    <!-- Cuerpo -->
    <div class="card-body">
      
      <div class="row justify-content-center">
       
        <!-- Columna data -->
        <div class="col-md-4 d-flex flex-column justify-content-center">
          <div class="d-flex mb-3">
            <i class="fas fa-calendar-day text-primary mt-1 me-3"></i>
            <div>
              <h6 class="mb-0 text-muted">Prediction Date</h6>
              <p class="mb-0 fw-bold">
                {{ predictedData?.date ? (predictedData?.date | date:'dd MMM yyyy') : 'Not defined' }}
              </p>
            </div>
          </div>

          <div class="d-flex mb-3">
            <i class="fas fa-map-marker-alt text-primary mt-1 me-3"></i>
            <div>
              <h6 class="mb-0 text-muted">Site</h6>
              <p class="mb-0 fw-bold">{{ predictedData?.site ?? 'Not select' }}</p>
            </div>
          </div>

          <div class="d-flex mb-3">
            <i class="fas fa-seedling text-primary mt-1 me-3"></i>
            <div>
              <h6 class="mb-0 text-muted">Algae</h6>
              <p class="mb-0 fw-bold">{{ predictedData?.specie ?? 'Not select' }}</p>
            </div>
          </div>
        </div>

        <!-- Columna result Biomass-->
        <div class="col-md-4 d-flex flex-column align-items-center justify-content-center responsive-border">
          <h6 class="text-muted mb-1"><i class="fas fa-bacteria me-2"></i>Biomass</h6>
          <span class="badge bg-success text-white fs-4 px-4 py-2">
            {{ predictedData?.growth ?? '0' }} units
          </span>
          <!-- Canvas del gráfico -->
          <div *ngIf="predictedData" style="width: 100%; height: 170px; padding-top: 1rem;">
            <canvas id="biomassChart"></canvas>
          </div>
        </div>

        <!-- Columna parameters -->
        <div class="col-md-4 text-center d-flex flex-column justify-content-center pt-4">
        <div class="row justify-content-center ">
          <div class="col-6 mb-3 d-flex flex-column align-items-center">
            <h6 class="text-muted mb-1"><i class="fas fa-temperature-high me-2"></i>Temperature</h6>
            <span class="badge bg-info text-white fs-6">
              {{ predictedData?.temperature ?? '0.0' }} °C
            </span>
          </div>
          <div class="col-6 mb-3 d-flex flex-column align-items-center">
            <h6 class="text-muted mb-1"><i class="fas fa-water me-2"></i>DIN</h6>
            <span class="badge bg-danger text-white fs-6">
              {{ predictedData?.din ?? '0.0' }} mg/L
            </span>
          </div>
          <div class="col-6 mb-3 d-flex flex-column align-items-center">
            <h6 class="text-muted mb-1"><i class="fas fa-flask me-2"></i>NT</h6>
            <span class="badge bg-warning text-white fs-6">
              {{ predictedData?.nt ?? '0.0' }} mg/L
            </span>
          </div>
          <!-- <div class="col-6 mb-4 d-flex flex-column align-items-center">
            <h6 class="text-muted mb-1"><i class="fas fa-clock me-2"></i>Days after</h6>
            <span class="badge bg-secondary text-white fs-6">
              {{ predictedData?.days ?? '0' }} days
            </span>
          </div> -->
        </div>
        </div>

      </div>

    </div>
    
  </div>

</div>


